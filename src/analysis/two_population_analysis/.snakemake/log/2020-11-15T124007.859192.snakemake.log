Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	1	compound_smcpp
	1	dadi_sfs_to_fsc
	10	fit_dadi_model_to_msprime_sfs
	1	fsc_setup
	1	get_best_dadi_fsc_runs
	1	get_dadi_fsc_output
	1	plot_estimates
	1	run_fsc
	1	run_smcpp
	1	simulation
	1	smcpp_plot
	1	ts_to_dadi_sfs
	1	ts_to_smc
	23

[Sun Nov 15 12:40:27 2020]
rule simulation:
    input: .genetic_map_downloaded
    output: /code/src/simulations/kai-first/Intermediate/1845187043/chr22.trees
    jobid: 6
    wildcards: seeds=1845187043, chrms=chr22

[Sun Nov 15 12:44:22 2020]
Finished job 6.
1 of 23 steps (4%) done

[Sun Nov 15 12:44:22 2020]
rule ts_to_dadi_sfs:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/chr22.trees
    output: /code/src/simulations/kai-first/Intermediate/1845187043/chr22_dadi_joint_sfs.fs, /code/src/simulations/kai-first/Intermediate/1845187043/chr22_dadi_joint_sfs_with_nonvariant.fs
    jobid: 5
    wildcards: seeds=1845187043, chrms=chr22

[Sun Nov 15 12:44:30 2020]
Finished job 5.
2 of 23 steps (9%) done

[Sun Nov 15 12:44:30 2020]
rule dadi_sfs_to_fsc:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/chr22_dadi_joint_sfs_with_nonvariant.fs
    output: /code/src/simulations/kai-first/Intermediate/1845187043/fsc_analysis/IM_hum_jointDAFpop1_0.obs
    jobid: 19
    wildcards: seeds=1845187043, demo_model=IM_hum

[Sun Nov 15 12:44:33 2020]
Finished job 19.
3 of 23 steps (13%) done

[Sun Nov 15 12:44:33 2020]
rule fit_dadi_model_to_msprime_sfs:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/chr22_dadi_joint_sfs.fs
    output: /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_fit_2438360421.pdf, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_2438360421.txt
    jobid: 14
    wildcards: seeds=1845187043, demo_models=IM_fsc, fit_seeds=2438360421

[Sun Nov 15 12:45:42 2020]
Finished job 14.
4 of 23 steps (17%) done

[Sun Nov 15 12:45:42 2020]
rule fit_dadi_model_to_msprime_sfs:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/chr22_dadi_joint_sfs.fs
    output: /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_fit_561383553.pdf, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_561383553.txt
    jobid: 9
    wildcards: seeds=1845187043, demo_models=IM_fsc, fit_seeds=561383553

[Sun Nov 15 12:49:03 2020]
Finished job 9.
5 of 23 steps (22%) done

[Sun Nov 15 12:49:03 2020]
rule fit_dadi_model_to_msprime_sfs:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/chr22_dadi_joint_sfs.fs
    output: /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_fit_170765737.pdf, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_170765737.txt
    jobid: 11
    wildcards: seeds=1845187043, demo_models=IM_fsc, fit_seeds=170765737

[Sun Nov 15 13:10:17 2020]
Finished job 11.
6 of 23 steps (26%) done

[Sun Nov 15 13:10:17 2020]
rule fit_dadi_model_to_msprime_sfs:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/chr22_dadi_joint_sfs.fs
    output: /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_fit_878579710.pdf, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_878579710.txt
    jobid: 12
    wildcards: seeds=1845187043, demo_models=IM_fsc, fit_seeds=878579710

[Sun Nov 15 13:30:31 2020]
Finished job 12.
7 of 23 steps (30%) done

[Sun Nov 15 13:30:31 2020]
rule fit_dadi_model_to_msprime_sfs:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/chr22_dadi_joint_sfs.fs
    output: /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_fit_789925284.pdf, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_789925284.txt
    jobid: 10
    wildcards: seeds=1845187043, demo_models=IM_fsc, fit_seeds=789925284

[Sun Nov 15 13:37:55 2020]
Finished job 10.
8 of 23 steps (35%) done

[Sun Nov 15 13:37:55 2020]
rule fit_dadi_model_to_msprime_sfs:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/chr22_dadi_joint_sfs.fs
    output: /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_fit_1358822685.pdf, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_1358822685.txt
    jobid: 8
    wildcards: seeds=1845187043, demo_models=IM_fsc, fit_seeds=1358822685

[Sun Nov 15 13:38:15 2020]
Finished job 8.
9 of 23 steps (39%) done

[Sun Nov 15 13:38:15 2020]
rule ts_to_smc:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/chr22.trees
    output: /code/src/simulations/kai-first/Intermediate/1845187043/chr22.treespop1.smc.gz, /code/src/simulations/kai-first/Intermediate/1845187043/chr22.treespop2.smc.gz
    jobid: 22
    wildcards: seeds=1845187043, chrms=chr22

[Sun Nov 15 13:39:04 2020]
Finished job 22.
10 of 23 steps (43%) done

[Sun Nov 15 13:39:04 2020]
rule run_smcpp:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/chr22.treespop1.smc.gz, /code/src/simulations/kai-first/Intermediate/1845187043/chr22.treespop2.smc.gz
    output: /code/src/simulations/kai-first/Intermediate/1845187043/model.final.pop1.json, /code/src/simulations/kai-first/Intermediate/1845187043/model.final.pop2.json
    jobid: 21
    wildcards: seeds=1845187043

[Sun Nov 15 13:43:59 2020]
Finished job 21.
11 of 23 steps (48%) done

[Sun Nov 15 13:43:59 2020]
rule smcpp_plot:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/model.final.pop1.json, /code/src/simulations/kai-first/Intermediate/1845187043/model.final.pop2.json
    output: /code/src/simulations/kai-first/Intermediate/1845187043/trees.smc.gz.final.json.csv, /code/src/simulations/kai-first/Intermediate/1845187043/split/model.final.json, /code/src/simulations/kai-first/Intermediate/1845187043/split/joint.csv
    jobid: 20
    wildcards: seeds=1845187043

[Sun Nov 15 13:44:25 2020]
Finished job 20.
12 of 23 steps (52%) done

[Sun Nov 15 13:44:25 2020]
rule compound_smcpp:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/split/model.final.json
    output: /code/src/simulations/kai-first/Results/smcpp_estimated_Ne.png
    jobid: 23

[Sun Nov 15 13:44:31 2020]
Finished job 23.
13 of 23 steps (57%) done

[Sun Nov 15 13:44:31 2020]
rule fit_dadi_model_to_msprime_sfs:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/chr22_dadi_joint_sfs.fs
    output: /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_fit_3823185381.pdf, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_3823185381.txt
    jobid: 4
    wildcards: seeds=1845187043, demo_models=IM_fsc, fit_seeds=3823185381

[Sun Nov 15 13:44:56 2020]
Finished job 4.
14 of 23 steps (61%) done

[Sun Nov 15 13:44:56 2020]
rule fsc_setup:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/fsc_analysis/IM_hum_jointDAFpop1_0.obs
    output: /code/src/simulations/kai-first/Intermediate/1845187043/fsc_analysis/IM_hum.est, /code/src/simulations/kai-first/Intermediate/1845187043/fsc_analysis/IM_hum.tpl
    jobid: 18
    wildcards: seeds=1845187043, demo_model=IM_hum

[Sun Nov 15 13:44:58 2020]
Finished job 18.
15 of 23 steps (65%) done

[Sun Nov 15 13:44:58 2020]
rule run_fsc:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/fsc_analysis/IM_hum.tpl
    output: /code/src/simulations/kai-first/Intermediate/1845187043/fsc_analysis/run10/IM_hum/IM_hum.bestlhoods
    jobid: 17
    wildcards: seeds=1845187043, demo_model=IM_hum

[Sun Nov 15 14:58:34 2020]
Finished job 17.
16 of 23 steps (70%) done

[Sun Nov 15 14:58:34 2020]
rule fit_dadi_model_to_msprime_sfs:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/chr22_dadi_joint_sfs.fs
    output: /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_fit_2557845021.pdf, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_2557845021.txt
    jobid: 16
    wildcards: seeds=1845187043, demo_models=IM_fsc, fit_seeds=2557845021

[Sun Nov 15 14:59:03 2020]
Finished job 16.
17 of 23 steps (74%) done

[Sun Nov 15 14:59:03 2020]
rule fit_dadi_model_to_msprime_sfs:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/chr22_dadi_joint_sfs.fs
    output: /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_fit_3549516158.pdf, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_3549516158.txt
    jobid: 13
    wildcards: seeds=1845187043, demo_models=IM_fsc, fit_seeds=3549516158

[Sun Nov 15 15:02:49 2020]
Finished job 13.
18 of 23 steps (78%) done

[Sun Nov 15 15:02:49 2020]
rule fit_dadi_model_to_msprime_sfs:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/chr22_dadi_joint_sfs.fs
    output: /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_fit_2285257250.pdf, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_2285257250.txt
    jobid: 15
    wildcards: seeds=1845187043, demo_models=IM_fsc, fit_seeds=2285257250

[Sun Nov 15 15:10:48 2020]
Finished job 15.
19 of 23 steps (83%) done

[Sun Nov 15 15:10:49 2020]
rule get_dadi_fsc_output:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_3823185381.txt, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_1358822685.txt, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_561383553.txt, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_789925284.txt, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_170765737.txt, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_878579710.txt, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_3549516158.txt, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_2438360421.txt, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_2285257250.txt, /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/IM_fsc/model_params_2557845021.txt, /code/src/simulations/kai-first/Intermediate/1845187043/fsc_analysis/run10/IM_hum/IM_hum.bestlhoods
    output: /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/dadi_results_sorted.txt, /code/src/simulations/kai-first/Intermediate/1845187043/fsc_analysis/fsc_results_sorted.txt
    jobid: 3
    wildcards: seeds=1845187043

[Sun Nov 15 15:10:52 2020]
Finished job 3.
20 of 23 steps (87%) done

[Sun Nov 15 15:10:52 2020]
rule get_best_dadi_fsc_runs:
    input: /code/src/simulations/kai-first/Intermediate/1845187043/dadi_analysis/dadi_results_sorted.txt, /code/src/simulations/kai-first/Intermediate/1845187043/fsc_analysis/fsc_results_sorted.txt, /code/src/simulations/kai-first/Intermediate/1845187043/split/joint.csv
    output: /code/src/simulations/kai-first/Results/best_fsc_runs.txt, /code/src/simulations/kai-first/Results/best_dadi_runs.txt, /code/src/simulations/kai-first/Results/smcpp_runs.txt
    jobid: 2

[Sun Nov 15 15:10:55 2020]
Finished job 2.
21 of 23 steps (91%) done

[Sun Nov 15 15:10:55 2020]
rule plot_estimates:
    input: /code/src/simulations/kai-first/Results/best_fsc_runs.txt, /code/src/simulations/kai-first/Results/best_dadi_runs.txt, /code/src/simulations/kai-first/Results/smcpp_runs.txt
    output: /code/src/simulations/kai-first/Results/estimates_N_tdiv_dadi_fsc_smcpp.png, /code/src/simulations/kai-first/Results/estimates_mig_dadi_fsc.png
    jobid: 1

[Sun Nov 15 15:11:01 2020]
Finished job 1.
22 of 23 steps (96%) done

[Sun Nov 15 15:11:01 2020]
localrule all:
    input: /code/src/simulations/kai-first/Results/estimates_N_tdiv_dadi_fsc_smcpp.png, /code/src/simulations/kai-first/Results/estimates_mig_dadi_fsc.png, /code/src/simulations/kai-first/Results/smcpp_estimated_Ne.png
    jobid: 0

[Sun Nov 15 15:11:01 2020]
Finished job 0.
23 of 23 steps (100%) done
Complete log: /code/src/analysis/two_population_analysis/.snakemake/log/2020-11-15T124007.859192.snakemake.log
